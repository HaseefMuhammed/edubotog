<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EB GENIE</title>
    <link rel="stylesheet" href="style2.css">
    <link rel="icon" href="images/icon.png" type="image/logo">
    <script src="https://kit.fontawesome.com/3945bc0b8d.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="bootstrap.css">
    <style>
      /* Standard clean UI styles */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}
.glass-bg, .glass-reflection {
  display: none !important;
}
.container {
  max-width: 600px;
  margin: 70px auto 30px auto;
  padding: 2.5rem 2rem 2rem 2rem;
  border-radius: 1.2rem;
  background: #fff;
  box-shadow: 0 2px 16px 0 rgba(60,60,60,0.07);
  text-align: center;
  position: relative;
  z-index: 2;
  border: 1px solid #e0e0e0;
  transition: box-shadow 0.2s;
}
.container:hover {
  box-shadow: 0 4px 24px 0 rgba(60,60,60,0.10);
}
nav.glassmorphism {
  background: #fff !important;
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  border-bottom: 1px solid #e0e0e0;
  box-shadow: 0 2px 8px 0 rgba(60,60,60,0.07);
  border-radius: 0 0 1rem 1rem;
  z-index: 10;
}
nav h4 {
  letter-spacing: 1px;
  font-weight: 600;
  font-size: 1.2rem;
  color: #222;
  text-shadow: none;
}
.icon-glow {
  filter: none;
  border-radius: 50%;
  margin-bottom: 1rem;
  width: 90px;
  height: 90px;
  object-fit: cover;
  background: #f5f6fa;
  padding: 0.5rem;
  box-shadow: 0 1px 4px #e0e0e0;
  animation: none;
}
h1 {
  font-family: 'Oswald', 'Arial', sans-serif;
  font-size: 2rem;
  font-weight: 700;
  letter-spacing: 1px;
  color: #222;
  text-shadow: none;
  margin-bottom: 1rem;
}
#responseText {
  font-size: 1rem;
  color: #222;
  white-space: pre-wrap;
  background: #f5f6fa;
  border-radius: 0.8rem;
  padding: 1rem 1.2rem;
  margin-top: 1.2rem;
  box-shadow: 0 1px 4px #e0e0e0;
  border: 1px solid #e0e0e0;
  transition: background 0.2s, box-shadow 0.2s;
  animation: none;
}
#responseText:empty {
  background: none;
  box-shadow: none;
  border: none;
}
button, .btn {
  background: #4a69bd;
  color: #fff;
  border: none;
  border-radius: 1rem;
  padding: 0.6rem 2rem;
  font-size: 1rem;
  font-weight: 600;
  box-shadow: 0 1px 4px #e0e0e0;
  margin: 0.5rem 0;
  transition: background 0.2s, box-shadow 0.2s, transform 0.2s;
  outline: none;
  position: relative;
  overflow: hidden;
}
button:hover, .btn:hover {
  background: #3867d6;
  box-shadow: 0 2px 8px #b2bec3;
  transform: translateY(-1px) scale(1.03);
}
dialog {
  border-radius: 1rem;
  background: #fff;
  box-shadow: 0 2px 16px #e0e0e0;
  border: 1px solid #e0e0e0;
  color: #222;
  font-size: 1rem;
  padding: 1.5rem 1rem 1rem 1rem;
  z-index: 20;
  transition: box-shadow 0.2s;
}
dialog button {
  margin-top: 1rem;
  background: #4a69bd;
  color: #fff;
  border-radius: 0.8rem;
  font-size: 1rem;
  font-weight: 600;
  box-shadow: 0 1px 4px #e0e0e0;
  text-align: center;
  margin-left: auto;
  margin-right: auto;
  display: block;
}
dialog button:hover {
  background: #3867d6;
  box-shadow: 0 2px 8px #b2bec3;
}
@media (max-width: 700px) {
  .container {
    max-width: 98vw;
    padding: 1.2rem 0.5rem;
  }
  h1 {
    font-size: 1.3rem;
  }
  .icon-glow {
    width: 60px;
    height: 60px;
  }
}
    </style>
</head>
<body class="bg-dark">
      <!-- All rights resieved from FLOWWAY PUBLICATIONS 
  THIS IS UNDER LICENSE TO KNOW ABOUT LICENCE PLEASE VISIT WWW.WEBCRAAFT.42WEB.IO/CONTACT
  IF YOU ARE MAKING COPY OF THE ORGINAL ONE YOU MIGHT RESIEVE COPYWRITE AND WE WILL MAKE A COMPLAINT ON COURT.

  -----TO GET LICENSE PLEASE VISIT WWW.WEBCRAAFT.42WEB.IO-----------
  
  ------------

  IF YOU WANT AN OPERATING SYSTEM PLEASE VISIT WWW.WEBCRAAFT.42WEB.IO /OR/ HASEEF-WS.NETLIFY.APP

  LICENSE NO :  HW-FL-MB-001-2024
  ©2024


  ----- Dont use this operationg system without lisence-----
  copyright 2024 Haseef Muhammed
  Web Craft and Any Time Services
  Library FLowwaypc
  css library: Haseef Swift language
  Server Git Hub
  This website already hosted on netlify inc
  -->

     <!-- Preloader -->
     <div id="preloader">
    </div>


<header>
    <nav  class="fixed-top glassmorphism">
        <h4 class="text-dark p-1 mx-4"><a id="tap" onclick="audio.play()" class="text-white tap" href="home.html"> <i class="fa-solid text-dark fa-arrow-left"></i></a> EB ASSISTANT</h4>
    </nav>
</header>
<div class="p-3"></div>
<section class="mt-5">
  <!-- Copy from voice ai by ats -->
  <dialog>
    <button autofocus>Close</button>
    <p>Ask a question like "Hey teahcer something..."</p>
  </dialog>

<div class="container">
    <img src="images/voiceast.gif" alt="" class="icon-glow">
    <h1>EDU BOT ASSISTANT</h1>
    <div id="response">
        <p id="responseText">Say "Hey Teacher" to start...</p>
    </div>
</div>
</section>




    
    <script src="preload.js"></script>
    <script src="script.js"></script>
   <script src="bootstrap.js"></script>

   <script>
    const apiKey = 'AIzaSyCGPmYZNx_p5sdrkjLQx_DKyLx5M7Vl32Q'; // Replace with your actual API key
const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`;

window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
const recognition = new SpeechRecognition();
recognition.continuous = true;
recognition.interimResults = false;
recognition.lang = 'en-US';

let isRecognitionRunning = false;

const predefinedResponses = {
    "what is your name": "My name is Edu Bot Ai.",
    "who is your developer": "Haseef Muhammed is my developer. You can visit his website at haseef-ws.netlify.app.",
    "who made you": "Made by by Haseef, Agney, Archith, and Niranjan.",
    "where are you from": "I belong to p.m.s.a.p.t.h.s.s Kakkove . ATL Lab",
    "who is your designer": "Agney. A. is a multifaceted talent, excelling as a singer, designer, and technician. With a passion for music, Agney A delivers captivating performances that resonate with audiences. His design skills and technical expertise complement his artistic endeavors, creating a unique blend of creativity and precision.",
    "tell me a welcome speech": "Chirak vijayakaramayi aaghōshikkaanaya ella vidyarthikalkum, adhyapakarum abhinandanangal. Ee kalamela ningalude kazhivukale puthiya uyaranngalil ethichirikkatte. Thank you, and enjoy the show! ",
    "please inaugurate": "Welcome to Futuristic A.T.L EXPO 2K24-25 at P.M.S.A.P.T.H.S.S. Kakkove! Today, we enter a world where ideas turn into reality and creativity knows no limits. This expo is a celebration of young minds shaping the future through technology and innovation. Let’s ignite curiosity, embrace challenges, and create solutions that redefine tomorrow. The future starts here, with YOU! .Let the innovations begin!. njaan ninggaludee swantham A.I Teacher, EDU Bot A.I , ninggaludee kuudee expoyil njaanum undaakum. nanhhi."
};

recognition.onresult = (event) => {
    const transcript = event.results[event.results.length - 1][0].transcript.trim();
    console.log('Transcript:', transcript);

    const normalizedTranscript = transcript.toLowerCase();

    if (normalizedTranscript.includes('hey teacher')) {
        const question = normalizedTranscript.replace(/hey teacher/i, '').trim();
        if (question) {
            if (predefinedResponses[question]) {
                const responseText = predefinedResponses[question];
                document.getElementById('responseText').textContent = responseText;
                speakText(responseText);
            } else {
                document.getElementById('responseText').textContent = `You asked: "${question}"`;
                fetchContent(question);
            }
        } else {
            document.getElementById('responseText').textContent = 'Please ask a question after saying "Hey Teacher".';
        }
    }
};

recognition.onend = () => {
    console.log('Recognition ended, restarting...');
    isRecognitionRunning = false;
    startRecognition();
};

function startRecognition() {
    if (!isRecognitionRunning) {
        recognition.start();
        isRecognitionRunning = true;
    }
}

startRecognition();

function fetchContent(text) {
    fetch(endpoint, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            contents: [
                {
                    parts: [
                        {
                            text: text
                        }
                    ]
                }
            ]
        })
    })
    .then(response => {
        if (!response.ok) {
            return response.text().then(errorMessage => {
                throw new Error(`HTTP error! Status: ${response.status}, Message: ${errorMessage}`);
            });
        }
        return response.json();
    })
    .then(data => {
        console.log('API Response:', data);

        const candidates = data.candidates || [];
        const responseText = candidates.length > 0 && candidates[0].content && candidates[0].content.parts && candidates[0].content.parts[0] && candidates[0].content.parts[0].text;

        if (responseText) {
            const cleanedResponse = stripMarkdown(responseText);
            document.getElementById('responseText').textContent = cleanedResponse;
            speakText(cleanedResponse);
        } else {
            document.getElementById('responseText').textContent = 'No response from API.';
            startRecognition();
        }
    })
    .catch(error => {
        console.error('Error details:', error);
        document.getElementById('responseText').textContent = `Sorry, there was an error: ${error.message}`;
        startRecognition();
    });
}

// Function to strip markdown formatting from text
function stripMarkdown(text) {
    return text
        .replace(/\*\*([^\*]+)\*\*/g, '$1') // Remove bold formatting
        .replace(/\*([^\*]+)\*/g, '$1') // Remove italic formatting
        .replace(/(^|\s)#[^\s]+/g, '') // Remove headers
        .replace(/!\[.*?\]\(.*?\)/g, '') // Remove images
        .replace(/\[.*?\]\(.*?\)/g, '') // Remove links
        .replace(/`{1,3}.*?`{1,3}/g, '') // Remove inline code and code blocks
        .trim();
}

// Function to read the text aloud with a female voice and limit to 20 seconds
function speakText(text) {
    const utterance = new SpeechSynthesisUtterance(text);
    const voices = window.speechSynthesis.getVoices();
    const femaleVoice = voices.find(voice => voice.name.includes('Female')) || voices[0];

    if (femaleVoice) {
        utterance.voice = femaleVoice;
    }

    const readTimeLimit = 60000; // 60 seconds
    let speakingTimeout;

    utterance.onend = () => {
        console.log('Speech ended.');
        document.getElementById('responseText').textContent += '\nYou can read from the screen.';
        clearTimeout(speakingTimeout);
        setTimeout(startRecognition, 1000); // Delay before restarting recognition
    };

    utterance.onerror = (event) => {
        console.error('SpeechSynthesisUtterance.onerror', event);
        clearTimeout(speakingTimeout);
        setTimeout(startRecognition, 1000); // Delay before restarting recognition
    };

    // Stop recognition while speaking
    recognition.stop();
    isRecognitionRunning = false;
    window.speechSynthesis.speak(utterance);

    speakingTimeout = setTimeout(() => {
        window.speechSynthesis.cancel();
        document.getElementById('responseText').textContent += '\nYou can read from the screen.';
        setTimeout(startRecognition, 1000); // Delay before restarting recognition
    }, readTimeLimit); // Stop speaking after 20 seconds
}

// Ensure voices are loaded and set up
window.speechSynthesis.onvoiceschanged = () => {
    const voices = window.speechSynthesis.getVoices();
    console.log('Voices:', voices);
};


// Dialog

const dialog = document.querySelector("dialog");
const showButton = document.querySelector("dialog + button");
const closeButton = document.querySelector("dialog button");

// "Show the dialog" button opens the dialog modally
 dialog.showModal();
// showButton.addEventListener("click", () => {
//   dialog.showModal();
// });

// "Close" button closes the dialog
closeButton.addEventListener("click", () => {
  dialog.close();
});




   </script>
</body>
</html>